section .data
	filename: db 'message.txt', 0

section .bss              ; uninitialized data
	fd resd 1         ; reserve 1 word
	l equ 13
        message resb l    ; reserve 13 bytes

section .text
	global _start

_start:
	mov eax, 5        ; open system call
	mov ebx, filename ; filename goes in ebx
	mov ecx, 0        ; read only
	int 80h           ; returns file descriptor in eax

	mov [fd], eax     ; fd = open(filename, O_RDONLY);

	mov eax, 3        ; read system call
	mov ebx, [fd]     ; fd goes in ebx
        mov ecx, message  ; buffer address in ecx
	mov edx, l        ; buffer length in edx
	int 80h           ; read(fd, message, l);
	
	mov eax, 4        ; write system call
	mov ebx, 1        ; file descriptor goes in ebx, 1 - standard output
	mov ecx, message  ; address of the buffer
	mov edx, l        ; length of the buffer 
	int 80h           ; write(1, message, l);

        mov eax, 6        ; close system call
        mov ebx, [fd]     ; fd goes in ebx
        int 80h           ; close(fd);

	mov eax, 1        ; exit system call
	mov ebx, 0        ; return value
	int 80h           ; exit(0);
